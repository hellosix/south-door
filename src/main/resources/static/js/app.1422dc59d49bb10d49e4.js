webpackJsonp([1],{"6qiM":function(e,t){},AXe6:function(e,t){},AqYs:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTYyNTIzMzgwMjU1IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjkyNyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48ZGVmcz48c3R5bGUgdHlwZT0idGV4dC9jc3MiPjwvc3R5bGU+PC9kZWZzPjxwYXRoIGQ9Ik03MzEuNDc3MzMzIDg3Ny43Mzg2NjdIMTQ2LjM0NjY2N0ExNDYuMjE4NjY3IDE0Ni4yMTg2NjcgMCAwIDAgMjkyLjUyMjY2NyAxMDI0aDQzOC44NjkzMzNhMTQ2LjI2MTMzMyAxNDYuMjYxMzMzIDAgMCAwIDE0Ni4yNjEzMzMtMTQ2LjI2MTMzM1YyNzYuOTkyYTUuMjQ4IDUuMjQ4IDAgMCAwLTUuMjkwNjY2LTUuMzMzMzMzaC0xMzUuNjhhNS4zMzMzMzMgNS4zMzMzMzMgMCAwIDAtNS4yNDggNS4zNzZ2NjAwLjc0NjY2NnogbTAtODc3LjczODY2N2ExNDYuMzA0IDE0Ni4zMDQgMCAwIDEgMTQ2LjIxODY2NyAxNDYuMzQ2NjY3SDI5Mi42MDh2NjAwLjY2MTMzM2E1LjM3NiA1LjM3NiAwIDAgMS01LjMzMzMzMyA1LjMzMzMzM0gxNTEuNjM3MzMzYTUuMzMzMzMzIDUuMzMzMzMzIDAgMCAxLTUuMzMzMzMzLTUuMzMzMzMzVjE0Ni4yNjEzMzNBMTQ2LjMwNCAxNDYuMzA0IDAgMCAxIDI5Mi41MjI2NjcgMGg0MzguOTEyIiBmaWxsPSIjMDA3ZmZmIiBwLWlkPSI5MjgiPjwvcGF0aD48L3N2Zz4="},Enrq:function(e,t){},FiRf:function(e,t){},Melv:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("7+uW"),o=i("zL8q"),s=i.n(o),a=(i("tvR6"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app1"}},[t("router-view")],1)},staticRenderFns:[]});var n=i("VU/8")({name:"app",components:{}},a,!1,function(e){i("FiRf")},null,null).exports,l=i("/ocq"),u=i("mvHQ"),c=i.n(u),d=i("NYxO"),p=i("424j");i("lbHh");function g(e){return null==e||"undefined"===e||""===e||"null"===e}function m(e){return!g(e)}r.default.use(d.a);var f={getKeywords:function(e){return e.keywords},filterSiteList:function(e){var t=e.keywords.toLocaleLowerCase();return e.siteList.filter(function(e){return e.siteName.toLocaleLowerCase().includes(t)}).sort(function(e,t){var i=e.siteName,r=e.rate;g(r)&&(r=0);var o=t.siteName,s=t.rate;return g(s)&&(s=0),r<s?1:r>s?-1:i.localeCompare(o,"zh-CN")})},getGroupList:function(e){return e.groupList},getSiteRateMap:function(e){return e.siteRateMap}};var h=new d.a.Store({state:{keywords:"",siteList:[],groupList:[],siteRateMap:{}},getters:f,actions:{setKeywords:function(e,t){e.commit("setKeywords",t)},setSiteList:function(e,t){e.commit("setSiteList",t)},setGroupList:function(e,t){e.commit("setGroupList",t)},setSiteRateMap:function(e,t){e.commit("setSiteRateMap",t)}},mutations:{setKeywords:function(e,t){e.keywords=t},setSiteList:function(e,t){e.siteList=t},setGroupList:function(e,t){e.groupList=t},setSiteRateMap:function(e,t){e.siteRateMap[t.siteId]=t.rate}},plugins:[Object(p.a)({reducer:function(e){return{siteRateMap:e.siteRateMap}}})]}),I={name:"Index",components:{},data:function(){return{activeIndex:"",keywords:h.getters.getKeywords,currentGroupName:"Group List",groupId:"",isLogin:!1,showLogin:!1,userInfo:{userName:"",password:"",headPic:""},groupList:h.getters.getGroupList}},methods:{notifyToSignIn:function(){this.$notify({title:"Not Logged In",message:"Please log in first",offset:100,duration:2e3}),this.activeIndex=""},userLogin:function(){sessionStorage.removeItem("user"),this.showLogin=!0,this.isLogin=!1},logout:function(){sessionStorage.removeItem("user"),this.isLogin=!1,this.$router.go(0)},loginSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$axios.post("/user/login",t.userInfo).then(function(e){0==e.data.code?(t.userInfo=e.data.data,sessionStorage.setItem("user",c()({userName:t.userInfo.userName,headPic:t.userInfo.headPic})),t.showLogin=!1,t.isLogin=!0,t.$router.go(0)):t.$message.error("user name or password wrong")}).catch(function(e){t.$message.error("Network error")})})},handleSelect:function(e,t){sessionStorage.getItem("user")?localStorage.setItem("activeIndex",e):localStorage.setItem("activeIndex","")},toGroupManage:function(){sessionStorage.getItem("user")?this.$router.push({name:"group-manage"}):this.notifyToSignIn()},toSiteManage:function(){sessionStorage.getItem("user")?this.$router.push({name:"site-manage"}):this.notifyToSignIn()},handleSelectGroup:function(e){this.groupId=e.groupId,this.currentGroupName=e.groupName,localStorage.setItem("lastSelectedGroup",c()({groupId:e.groupId,groupName:e.groupName})),this.$router.push({name:"site-group",params:{groupId:e.groupId}})},getGroupList:function(){var e=this;this.$axios.get("/group/getGroupList").then(function(t){e.groupList=t.data.sort(function(e,t){return e.groupName.localeCompare(t.groupName,"zh-CN")}),h.dispatch("setGroupList",e.groupList)}).catch(function(t){e.$message.error("Network error")})}},watch:{keywords:function(){h.dispatch("setKeywords",this.keywords)}},mounted:function(){var e=sessionStorage.getItem("user");if(e&&(e=JSON.parse(e),this.userInfo.userName=e.userName,this.userInfo.headPic=e.headPic,this.isLogin=!0),-1===this.$route.path.indexOf("manage")){var t=JSON.parse(localStorage.getItem("lastSelectedGroup"));t?(this.groupId=t.groupId,this.groupId&&(this.currentGroupName=t.groupName,localStorage.setItem("activeIndex",this.groupId),this.$router.push({name:"site-group",params:{groupId:this.groupId}}))):this.$router.push({name:"main-page"})}this.getGroupList(),this.activeIndex=localStorage.getItem("activeIndex")}},v={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",[r("div",{staticClass:"header-fixed"},[r("el-header",[r("a",{staticClass:"logo",attrs:{underline:!1,href:"/"}},[r("img",{staticClass:"logo-icon",attrs:{src:i("AqYs")}}),e._v("South Door\n      ")]),e._v(" "),r("el-menu",{attrs:{"default-active":e.activeIndex,mode:"horizontal","active-text-color":"#007fff","menu-trigger":"click"},on:{select:e.handleSelect}},[r("el-menu-item",{staticClass:"no-active"},[r("el-input",{attrs:{size:"small",placeholder:"Search by site name","prefix-icon":"el-icon-search"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),r("el-submenu",{staticClass:"nav-item",attrs:{index:"0"}},[r("template",{slot:"title"},[e._v(e._s(e.currentGroupName))]),e._v(" "),e._l(e.groupList,function(t){return r("el-menu-item",{key:t.groupId,staticClass:"nav-item",attrs:{index:t.groupId},on:{click:function(i){return e.handleSelectGroup(t)}}},[e._v(e._s(t.groupName))])})],2),e._v(" "),r("el-menu-item",{staticClass:"nav-item",attrs:{index:"1"},on:{click:e.toGroupManage}},[e._v("Group Manage")]),e._v(" "),r("el-menu-item",{staticClass:"nav-item",attrs:{index:"2"},on:{click:e.toSiteManage}},[e._v("Site Manage")]),e._v(" "),r("el-menu-item",{staticClass:"user-info no-active",attrs:{index:"-1"}},[e.isLogin?r("el-dropdown",{attrs:{trigger:"hover"}},[r("span",{staticClass:"el-dropdown-link userinfo-inner"},[r("img",{staticClass:"head-pic",attrs:{src:e.userInfo.headPic}}),e._v("\n              "+e._s(e.userInfo.userName)+"\n            ")]),e._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{nativeOn:{click:function(t){return e.logout()}}},[e._v("Sign out")])],1)],1):r("span",{staticClass:"nav-item",on:{click:function(t){return e.userLogin()}}},[e._v("Sign In")])],1)],1)],1)],1),e._v(" "),r("el-main",{staticClass:"main-body"},[r("router-view")],1),e._v(" "),r("el-dialog",{attrs:{title:"Sign In",visible:e.showLogin,width:"25%","custom-class":"login-wrapper"},on:{"update:visible":function(t){e.showLogin=t}}},[r("el-form",{ref:"userInfo",attrs:{model:e.userInfo,"label-position":"top"}},[r("el-form-item",{attrs:{prop:"userName",rules:[{required:!0,message:"Please enter user name"}]}},[r("el-input",{attrs:{placeholder:"Please enter user name","prefix-icon":"el-icon-user"},model:{value:e.userInfo.userName,callback:function(t){e.$set(e.userInfo,"userName",t)},expression:"userInfo.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"password",rules:[{required:!0,message:"Please enter password"}]}},[r("el-input",{attrs:{placeholder:"Please enter password","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.userInfo.password,callback:function(t){e.$set(e.userInfo,"password",t)},expression:"userInfo.password"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticClass:"login-button",attrs:{type:"primary"},on:{click:function(t){return e.loginSubmit("userInfo")}}},[e._v("Login")])],1)],1)],1)},staticRenderFns:[]};var N=i("VU/8")(I,v,!1,function(e){i("6qiM")},null,null).exports,w=i("BO1k"),M=i.n(w),L={props:["groupId"],name:"site-list",data:function(){return{colors:["#99A9BF","#F7BA2A","#FF9900"],siteList:[],canEdit:!1}},methods:{getSiteList:function(e){var t=this;this.$axios.get("/site/getSiteByGroupId?groupId="+e).then(function(e){var i=e.data.data,r=h.getters.getSiteRateMap,o=!0,s=!1,a=void 0;try{for(var n,l=M()(i);!(o=(n=l.next()).done);o=!0){var u=n.value,c=r[u.siteId];m(c)&&(u.rate=c)}}catch(e){s=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw a}}t.siteList=i,h.dispatch("setSiteList",t.siteList)}).catch(function(e){console.log(e),t.$message.error("Network error")})},handleEdit:function(e){this.$router.push({name:"site-edit",params:{siteId:e}})},rateChange:function(e,t){var i={siteId:e,rate:t};h.commit("setSiteRateMap",i)}},watch:{groupId:function(e){this.getSiteList(e)}},computed:{filterSiteList:function(){return h.getters.filterSiteList}},mounted:function(){var e=this.$route.params.groupId,t=h.getters.getGroupList;for(var i in t)i.groupId==e&&localStorage.setItem("lastSelectedGroup",c()({groupId:i.groupId,groupName:i.groupName}));e&&this.getSiteList(e),sessionStorage.getItem("user")&&(this.canEdit=!0)}},x={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-row",{attrs:{gutter:20,id:"site-list"}},e._l(e.filterSiteList,function(t){return i("el-col",{key:t.siteId,attrs:{xl:4,lg:6,md:8,sm:12,"site-id":t.siteId}},[i("div",{staticClass:"card-wrapper"},[i("div",{staticClass:"image-wrapper"},[i("a",{attrs:{href:t.proxyAddress,target:"_blank"}},[i("el-image",{staticClass:"image site-image",attrs:{fit:"cover",src:t.imagePath}})],1)]),e._v(" "),i("div",{staticClass:"content-wrapper"},[i("div",{staticClass:"content-item between"},[i("div",{staticClass:"name-wrapper"},[e._v(e._s(t.siteName))]),e._v(" "),i("el-rate",{staticClass:"rate-font",attrs:{colors:e.colors},on:{change:function(i){return e.rateChange(t.siteId,t.rate)}},model:{value:t.rate,callback:function(i){e.$set(t,"rate",i)},expression:"site.rate"}})],1),e._v(" "),i("div",{staticClass:"content-item between"},[i("div",{staticClass:"color-text-secondary description"},[e._v(e._s(t.description))]),e._v(" "),e.canEdit?i("i",{staticClass:"el-icon-edit operation-icon",on:{click:function(i){return e.handleEdit(t.siteId)}}}):e._e()])])])])}),1)},staticRenderFns:[]};var y=i("VU/8")(L,x,!1,function(e){i("y0tW")},null,null).exports,b={data:function(){return{siteList:[],search:"",isShowDeleteDialog:!1,showDeleteDialog:!1,deletingSite:{}}},methods:{clickEdit:function(e,t){this.$router.push({name:"site-edit",params:{siteId:t.siteId}})},clickDelete:function(e,t){this.deletingSite=t,this.showDeleteDialog=!0},confirmDeleteSite:function(){var e=this,t=this.deletingSite;m(t.siteId)&&(this.$axios.post("/site/deleteSiteById",t.siteId).then(function(i){0==i.data.code&&e.siteList.forEach(function(e,i,r){e.siteId==t.siteId&&r.splice(i,1)})}).catch(function(t){e.$message.error("Network error.")}),this.showDeleteDialog=!1)},createSite:function(){this.$router.push({name:"site-add"})}},mounted:function(){var e=this;sessionStorage.getItem("user")?this.$axios.get("/site/getAllSite").then(function(t){e.siteList=t.data.data}).catch(function(t){e.$message.error("Network error.")}):this.$router.push("/")}},D={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"create-wrapper"},[i("el-button",{staticClass:"right",attrs:{icon:"el-icon-plus",title:"Create group",size:"small"},on:{click:function(t){return e.createSite()}}},[e._v("CREAT")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.siteList.filter(function(t){return!e.search||t.siteName.toLowerCase().includes(e.search.toLowerCase())||t.groupName.toLowerCase().includes(e.search.toLowerCase())}),"default-sort":{prop:"siteName",order:"descending"},stripe:""}},[i("el-table-column",{attrs:{label:"Group",prop:"groupName",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{label:"Site Name",prop:"siteName",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{label:"Address",prop:"address",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{label:"Proxy Address",prop:"proxyAddress"}}),e._v(" "),i("el-table-column",{attrs:{label:"Proxy Port",prop:"proxyPort",sortable:"",width:"150px"}}),e._v(" "),i("el-table-column",{attrs:{label:"Description",prop:"description"}}),e._v(" "),i("el-table-column",{attrs:{label:"Date",prop:"updateTime",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{align:"right",width:"250px"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-input",{attrs:{size:"mini",placeholder:"search by keyworld"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(i){return e.clickEdit(t.$index,t.row)}}}),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(i){return e.clickDelete(t.$index,t.row)}}})]}}])})],1),e._v(" "),i("el-dialog",{attrs:{title:"Delete Site",visible:e.showDeleteDialog,width:"25%",center:!0,"custom-class":"delete-site-wrapper"},on:{"update:visible":function(t){e.showDeleteDialog=t}}},[i("span",[e._v("\n      Confirm to delete\n      "),i("b",[e._v(e._s(e.deletingSite.siteName))])]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.showDeleteDialog=!1}}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.confirmDeleteSite()}}},[e._v("Confirm")])],1)])],1)},staticRenderFns:[]};var C=i("VU/8")(b,D,!1,function(e){i("VjD/")},null,null).exports,z={data:function(){var e=this;return{search:"",showEditGroupDialog:!1,showDeleteDialog:!1,operationGroup:{},rules:{groupName:[{required:!0,validator:function(t,i,r){if(g(i)||g(i.trim()))return e.disabledUpload=!0,r(new Error("Please enter group name."));e.$axios.post("/validate/groupName",e.operationGroup).then(function(e){if(0!=e.data.code)return r(new Error("This group name "+i+" already exists."));r()}).catch(function(t){return e.$message.error("Network error."),r(new Error("Network error."))})},trigger:"change"}]}}},methods:{clickEdit:function(e,t){this.operationGroup=t,this.showEditGroupDialog=!0},clickDelete:function(e,t){this.operationGroup=t,this.showDeleteDialog=!0},confirmDeleteGroup:function(){var e=this,t=this.operationGroup;m(t.groupId)&&this.$axios.post("/group/deleteGroupById",t.groupId).then(function(i){0==i.data.code&&(e.groupList.forEach(function(e,i,r){e.groupId==t.groupId&&r.splice(i,1)}),h.dispatch("setGroupList",e.groupList))}).catch(function(t){e.$message.error("Network error.")}),this.showDeleteDialog=!1},showEditGroup:function(){this.operationGroup={},this.showEditGroupDialog=!0},submitGroup:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var i=h.getters.getGroupList,r=t.operationGroup;g(r.groupId)?t.$axios.post("/group/addGroup",r).then(function(e){0==e.data.code?(i.push(e.data.data),h.commit("setGroupList",i),t.showEditGroupDialog=!1):t.$message.error("create group failed.")}).catch(function(e){t.$message.error("Network error.")}):t.$axios.post("/group/updateGroup",r).then(function(e){0==e.data.code?(i.forEach(function(e,t){e.groupId==r.groupId&&(e=r)}),h.commit("setGroupList",i),t.showEditGroupDialog=!1):t.$message.error("update group failed.")}).catch(function(e){t.$message.error("Network error.")})}})}},computed:{groupList:function(){return h.getters.getGroupList}},mounted:function(){sessionStorage.getItem("user")||this.$router.push("/")}},j={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"create-wrapper"},[i("el-button",{staticClass:"right",attrs:{icon:"el-icon-plus",title:"Create group",size:"small"},on:{click:function(t){return e.showEditGroup()}}},[e._v("CREAT")])],1),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.groupList.filter(function(t){return!e.search||t.groupName.toLowerCase().includes(e.search.toLowerCase())}),stripe:""}},[i("el-table-column",{attrs:{label:"Group Name",prop:"groupName",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{label:"Description",prop:"description"}}),e._v(" "),i("el-table-column",{attrs:{label:"Date",prop:"updateTime",sortable:""}}),e._v(" "),i("el-table-column",{attrs:{align:"right",width:"250px"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-input",{attrs:{size:"mini",placeholder:"search by keyworld"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(i){return e.clickEdit(t.$index,t.row)}}}),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(i){return e.clickDelete(t.$index,t.row)}}})]}}])})],1),e._v(" "),i("el-dialog",{attrs:{title:"Edit Group",visible:e.showEditGroupDialog,width:"25%","custom-class":"new-group-wrapper"},on:{"update:visible":function(t){e.showEditGroupDialog=t}}},[i("el-form",{ref:"operationGroup",attrs:{"label-position":"top",rules:e.rules,model:e.operationGroup}},[i("el-form-item",{attrs:{prop:"groupName"}},[i("el-input",{staticClass:"group-input",attrs:{placeholder:"Please enter new group name","prefix-icon":"el-icon-s-flag",maxlength:"25","show-word-limit":""},model:{value:e.operationGroup.groupName,callback:function(t){e.$set(e.operationGroup,"groupName",t)},expression:"operationGroup.groupName"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"description"}},[i("el-input",{staticClass:"group-input",attrs:{placeholder:"Please enter description","prefix-icon":"el-icon-s-flag",maxlength:"25","show-word-limit":""},model:{value:e.operationGroup.description,callback:function(t){e.$set(e.operationGroup,"description",t)},expression:"operationGroup.description"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"new-group-button",attrs:{type:"primary"},on:{click:function(t){return e.submitGroup("operationGroup")}}},[e._v("Confirm")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"Delete Group",visible:e.showDeleteDialog,center:!0,"custom-class":"delete-site-wrapper"},on:{"update:visible":function(t){e.showDeleteDialog=t}}},[i("span",[e._v("\n     If there are sites in this group, then "),i("b",[e._v(e._s(e.operationGroup.groupName))]),e._v(" will not be deleted.\n    ")]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.showDeleteDialog=!1}}},[e._v("Cancel")]),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.confirmDeleteGroup()}}},[e._v("Confirm")])],1)])],1)},staticRenderFns:[]};var S=i("VU/8")(z,j,!1,function(e){i("Melv")},null,null).exports,k={data:function(){var e=this;return{rules:{siteName:[{required:!0,validator:function(t,i,r){if(g(i)||g(i.trim()))return e.disabledUpload=!0,r(new Error("Please enter site name."));e.$axios.post("/validate/siteName",e.siteInfo).then(function(t){if(0!=t.data.code)return e.disabledUpload=!0,r(new Error("This site name "+i+" already exists."));e.disabledUpload=!1,r()}).catch(function(t){e.$message.error("Network error.")})},trigger:"change"}],address:[{required:!0,validator:function(t,i,r){return g(i)?r(new Error("Please enter address!")):/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(i)?void e.$axios.post("/validate/address",i).then(function(e){if(0!=e.data.code)return r(new Error("connection refused!"));r()}).catch(function(t){e.$message.error("Network error.")}):r(new Error("Please enter right address!"))},trigger:"blur"}],proxyPort:[{validator:function(t,i,r){if(e.siteInfo.isProxy){if(g(i))return r(new Error("Please enter port!"));if(!function(e){return/^\d+$/.test(e)}(i))return r(new Error("Please enter integer for port!"));e.$axios.post("/validate/proxyPort",e.siteInfo).then(function(e){if(0!=e.data.code)return r(new Error("This port "+i+" has already been used!"));r()}).catch(function(t){e.$message.error("Network error.")})}else r()},trigger:"blur"}],groupId:[{required:!0,validator:function(e,t,i){if(g(t))return i(new Error("Please select one group!"));i()},trigger:"blur"}]},siteInfo:{siteId:"",groupId:"",siteName:"",isProxy:!1,proxyPort:""},disabledProxyPort:!0,groupId:"",fileList:[],image:{name:"",url:""},disabledUpload:!0,loading:!1}},methods:{goBack:function(){this.$router.go(-1)},handleCancel:function(){this.$router.go(-1)},submitSiteInfo:function(e){var t=this;this.disabledProxyPort&&(this.siteInfo.proxyPort=null),this.$refs[e].validate(function(e){e&&(t.loading=!0,t.siteInfo.groupId=t.groupId,t.$axios.post("/site/saveSiteInfo",t.siteInfo).then(function(e){t.loading=!0,0==e.data.code?t.$router.push({name:"site-manage"}):(t.loading=!1,t.$message.error("Save site info failed."))}).catch(function(e){t.loading=!1,t.$message.error("Network error.")}))})},changeProxyStatus:function(){this.disabledProxyPort=!this.siteInfo.isProxy},changeGroup:function(e){this.groupId=e},getSiteInfo:function(e){var t=this;this.$axios.get("/site/getSiteInfoById?siteId="+e).then(function(e){t.siteInfo=e.data.data,t.groupId=t.siteInfo.groupId,t.image.name=t.siteInfo.siteName,t.image.url=t.siteInfo.imagePath}).catch(function(e){t.$message.error("Network error.")})},handleAvatarSuccess:function(e,t,i){this.image.url=URL.createObjectURL(t.raw),this.loading=!1,this.$message({message:"Upload image successfully!",type:"success"})},handleImageError:function(e,t,i){this.loading=!1,this.$message.error("Upload image failed.")},beforeAvatarUpload:function(e){if(g(this.siteInfo.siteName))return this.$message.error("Please enter site name!"),!1;if(this.disabledUpload)return!1;var t="image/jpeg"===e.type||"image/png"===e.type,i=e.size/1024/1024<10;return t||this.$message.error("Uploading images can only be in JPG or PNG format!"),i||this.$message.error("Upload image size can't exceed 10MB!"),this.loading=!1,t&&i},handleChange:function(e,t){this.$message.info("Please delete current image.")}},computed:{groupList:function(){return h.getters.getGroupList}},mounted:function(){sessionStorage.getItem("user")||this.$router.push("/");var e=this.$route.params.siteId;m(e)&&this.getSiteInfo(e)}},_={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-row",[i("el-col",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{xs:24,sm:24,md:24,lg:12,xl:12,span:24}},[i("div",{staticClass:"grid-content bg-purple-dark"},[i("div",{staticStyle:{display:"block"}},[i("el-page-header",{staticClass:"page-header-wrapper",attrs:{title:"Back",content:e.siteInfo.siteName},on:{back:e.goBack}}),e._v(" "),i("div",{staticClass:"info-wrapper"},[i("el-form",{attrs:{"label-position":"right","label-width":"110px"}},[i("el-form-item",{attrs:{label:"Site Image"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{name:"siteImage",action:"/site/saveSiteImage","show-file-list":!1,"on-success":e.handleAvatarSuccess,"on-error":e.handleImageError,"before-upload":e.beforeAvatarUpload,"on-exceed":e.handleChange,data:e.siteInfo,disabled:e.disabledUpload}},[e.image.url?i("el-image",{staticClass:"avatar",attrs:{src:e.image.url,fit:"cover"}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1)],1),e._v(" "),i("el-form",{ref:"siteInfo",attrs:{"label-position":"right",rules:e.rules,model:e.siteInfo,"label-width":"110px"}},[i("el-form-item",{attrs:{label:"Site Name",prop:"siteName"}},[i("el-input",{attrs:{maxlength:"30","show-word-limit":""},model:{value:e.siteInfo.siteName,callback:function(t){e.$set(e.siteInfo,"siteName",t)},expression:"siteInfo.siteName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Group",prop:"groupId"}},[i("el-select",{attrs:{placeholder:"Please check one group"},on:{change:function(t){return e.changeGroup(t)}},model:{value:e.siteInfo.groupId,callback:function(t){e.$set(e.siteInfo,"groupId",t)},expression:"siteInfo.groupId"}},e._l(e.groupList,function(e){return i("el-option",{key:e.groupId,attrs:{index:e.groupId,label:e.groupName,value:e.groupId}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"Address",prop:"address"}},[i("el-input",{model:{value:e.siteInfo.address,callback:function(t){e.$set(e.siteInfo,"address",t)},expression:"siteInfo.address"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Is Proxy"}},[i("el-switch",{attrs:{change:e.changeProxyStatus()},model:{value:e.siteInfo.isProxy,callback:function(t){e.$set(e.siteInfo,"isProxy",t)},expression:"siteInfo.isProxy"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Proxy Port",prop:"proxyPort"}},[i("el-input",{attrs:{disabled:e.disabledProxyPort,maxlength:"6","show-word-limit":""},model:{value:e.siteInfo.proxyPort,callback:function(t){e.$set(e.siteInfo,"proxyPort",e._n(t))},expression:"siteInfo.proxyPort"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Description"}},[i("el-input",{attrs:{maxlength:"50","show-word-limit":""},model:{value:e.siteInfo.description,callback:function(t){e.$set(e.siteInfo,"description",t)},expression:"siteInfo.description"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitSiteInfo("siteInfo")}}},[e._v("Save")]),e._v(" "),i("el-button",{on:{click:function(t){return e.handleCancel()}}},[e._v("Cancel")])],1)],1)],1)],1)])])],1)},staticRenderFns:[]};var G=i("VU/8")(k,_,!1,function(e){i("AXe6")},null,null).exports,T={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"page-container"},[t("p",{staticClass:"code"},[this._v("404")]),this._v(" "),t("div",[this._v("找不到门了")]),this._v(" "),t("div",[t("el-link",{attrs:{href:"/"}},[this._v("返回首页")])],1)])},staticRenderFns:[]};var E=i("VU/8")(null,T,!1,function(e){i("RoHS")},null,null).exports,A={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"home-wrapper"},[t("img",{attrs:{src:i("xkwv")}}),this._v(" "),t("p",{staticClass:"welcome"},[this._v("Welcome to South Door!")])])}]};var P=i("VU/8")(null,A,!1,function(e){i("Enrq")},null,null).exports;r.default.use(l.a);var $=new l.a({routes:[{name:"index",path:"/",hidden:!0,component:N,children:[{name:"main-page",path:"/index",component:P},{name:"site-group",path:"/group/:groupId",component:y,props:!0},{name:"site-manage",path:"/site-manage",component:C},{name:"site-edit",path:"/manage/site-edit/:siteId",component:G},{name:"site-add",path:"/manage/add-site",component:G},{name:"group-manage",path:"/group-manage",component:S}]},{path:"/404",component:E,name:"404",hidden:!0},{path:"*",hidden:!0,redirect:{path:"/404"}}]}),R=i("mtWM"),Y=i.n(R);r.default.use(s.a),r.default.config.productionTip=!1,r.default.prototype.$axios=Y.a,Y.a.defaults.headers.post["Content-Type"]="application/json;charset=UTF-8",new r.default({el:"#app",vuex:d.a,router:$,components:{App:n},template:"<App/>"}),$.beforeEach(function(e,t,i){!g(sessionStorage.getItem("user"))||-1===e.path.indexOf("manage")&&-1===e.path.indexOf("edit")?i():i(t.path)})},RoHS:function(e,t){},"VjD/":function(e,t){},tvR6:function(e,t){},xkwv:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTYyNTIzNDg3OTk0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI3OTQiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNMTU5Ljc0NCAxMDEuODg4aDIxNy42YzUxLjIgMCA3Ni44IDI1LjYgNzYuOCA3Ni44djIxNy42YzAgNTEuMi0yNS42IDc2LjgtNzYuOCA3Ni44SDE1OS43NDRjLTUxLjIgMC03Ni44LTI1LjYtNzYuOC03Ni44VjE3OC42ODhjMC01MS4yIDI1LjYtNzYuOCA3Ni44LTc2Ljh6IiBmaWxsPSIjRDFEMUQxIiBwLWlkPSIyNzk1Ij48L3BhdGg+PHBhdGggZD0iTTc1MC41OTIgNzEuNjhjMTM2LjcwNCAwIDIwNC44IDY4LjA5NiAyMDQuOCAyMDQuOHMtNjguMDk2IDIwNC44LTIwNC44IDIwNC44LTIwNC44LTY4LjA5Ni0yMDQuOC0yMDQuOGMwLTEzNi4xOTIgNjguNjA4LTIwNC44IDIwNC44LTIwNC44eiIgZmlsbD0iIzAwN2ZmZiIgcC1pZD0iMjc5NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC43NzgxMDY5LjAuaTkiIGNsYXNzPSJzZWxlY3RlZCI+PC9wYXRoPjxwYXRoIGQ9Ik02NTIuOCA1ODEuMTJIODcwLjRjNTEuMiAwIDc2LjggMjUuNiA3Ni44IDc2LjhWODc1LjUyYzAgNTEuMi0yNS42IDc2LjgtNzYuOCA3Ni44aC0yMTcuNmMtNTEuMiAwLTc2LjgtMjUuNi03Ni44LTc2Ljh2LTIxNy42YzAtNTEuMiAyNS42LTc2LjggNzYuOC03Ni44eiIgZmlsbD0iI0QxRDFEMSIgcC1pZD0iMjc5NyI+PC9wYXRoPjxwYXRoIGQ9Ik0zMTEuMjk2IDYwNy4yMzJMNDcxLjA0IDg3NC40OTZjMTIuOCAyMC45OTIgNS42MzIgNDguNjQtMTUuMzYgNjEuNDQtNy4xNjggNC4wOTYtMTQuODQ4IDYuMTQ0LTIzLjA0IDYuMTQ0SDExMy4xNTJjLTI0LjU3NiAwLTQ1LjA1Ni0xOS45NjgtNDUuMDU2LTQ0LjU0NCAwLTguMTkyIDIuMDQ4LTE1Ljg3MiA2LjE0NC0yMy4wNGwxNTkuNzQ0LTI2Ny4yNjRjMTIuOC0yMC45OTIgMzkuOTM2LTI4LjE2IDYxLjQ0LTE1LjM2IDYuNjU2IDMuNTg0IDEyLjI4OCA4LjcwNCAxNS44NzIgMTUuMzZ6IiBmaWxsPSIjMDA3ZmZmIiBwLWlkPSIyNzk4IiBkYXRhLXNwbS1hbmNob3ItaWQ9ImEzMTN4Ljc3ODEwNjkuMC5pOCIgY2xhc3M9InNlbGVjdGVkIj48L3BhdGg+PC9zdmc+"},y0tW:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.1422dc59d49bb10d49e4.js.map